"0","# match KCs"
"0","ndat <- length(rdat)"
"0","KCnames <- rownames(rdat[[1]])"
"0","newrdat <- rdat"
"0","for (i in 1:5) {"
"0","    if (i %in% c(1,4,5)) { # KC is col"
"0","        ind <- match(KCnames,colnames(newrdat[[1]]))"
"0","        newrdat[[i]] <- newrdat[[i]][,ind]"
"0","    } else { # KC is row"
"0","        ind <- match(KCnames,rownames(newrdat[[1]]))"
"0","        newrdat[[i]] <- newrdat[[i]][ind,]"
"0","    }"
"0","}"
"0","# match MBIN c(2,4)"
"0","ind <- colnames(newrdat[[2]])"
"0","newrdat[[4]] <- newrdat[[4]][ind,]"
"0","newrdat[[6]] <- newrdat[[6]][ind,]"
"0","newrdat[[7]] <- newrdat[[7]][,ind]"
"0","# match MBON c(3,6,7,8)"
"0","ind <- colnames(newrdat[[3]])"
"0","newrdat[[6]] <- newrdat[[6]][,ind]"
"0","newrdat[[7]] <- newrdat[[7]][ind,]"
"0","newrdat[[8]] <- newrdat[[8]][ind,ind]"
"0","# form (KC,MBIN,MBON,PN)"
"0","vnames <- vnames2 <- NULL"
"0","for (i in 1:ndat) {"
"0","    vnames <- c(vnames, rownames(newrdat[[i]]), colnames(newrdat[[i]]))"
"0","    vnames2 <- c(vnames2, rep(vtype[i,1],nrow(newrdat[[i]])), rep(vtype[i,2],ncol(newrdat[[i]])))"
"0","}"
"0","#length(unique(vnames))"
"0","vdf <- data.frame(v=vnames,type=vnames2)"
"0","vdf <- subset(vdf, !duplicated(v)) # 226"
"0","(tab <- table(vdf$type))"
"1","
"
"1","  KC "
"1","MBIN "
"1","MBON "
"1","  PN "
"1","
"
"1"," 113 "
"1","  21 "
"1","  29 "
"1","  63 "
"1","
"
"0","n <- sum(tab)"
"0","cs <- cumsum(tab)"
"0","omni <- Matrix(0,n,n)"
"0","omni[1:cs[1],1:cs[1]] <- as.matrix(newrdat[[1]]) # KCxKC"
"0","omni[1:cs[1],(cs[1]+1):cs[2]] <- as.matrix(newrdat[[2]]) # KCxMBIN"
"0","omni[1:cs[1],(cs[2]+1):cs[3]] <- as.matrix(newrdat[[3]]) # KCxMBON"
"0","omni[1:cs[1],(cs[2]+1):cs[3]] <- as.matrix(newrdat[[3]]) # KCxMBON"
"0","omni[(cs[1]+1):cs[2],1:cs[1]] <- as.matrix(newrdat[[4]]) # MBINxKC"
"0","omni[(cs[1]+1):cs[2],(cs[2]+1):cs[3]] <- as.matrix(newrdat[[6]]) # MBINxMBON"
"0","omni[(cs[2]+1):cs[3],(cs[1]+1):cs[2]] <- as.matrix(newrdat[[7]]) # MBONxMBIN"
"0","omni[(cs[2]+1):cs[3],(cs[2]+1):cs[3]] <- as.matrix(newrdat[[8]]) # MBONxMBON"
"0","omni[(cs[3]+1):cs[4],1:cs[1]] <- as.matrix(newrdat[[5]]) # PNxKC"
"0","diag(omni) <- 0"
"0","rownames(omni) <- colnames(omni) <- vdf[,1]"
"0","cat(""full graph:\n"")"
"1","full graph:
"
"0","gomni <- graph.adjacency(omni,weighted=TRUE)"
"0","summary(gomni)"
"1","IGRAPH 6a69a94 DNW- 226 7560 -- "
"1","
"
"1","+ attr: name (v/c), weight (e/n)"
"1","
"
"0","cat(""connected and simplied (no self-loop & unweighted) graph:\n"")"
"1","connected and simplied (no self-loop & unweighted) graph:
"
"0","# remove isolates => lcc"
"0","iso <- which(degree(gomni)==0)"
"0","vdf <- vdf[-iso,]"
"0","tab2 <- table(vdf$type)"
"0","gomni <- delete_vertices(gomni,iso)"
"0","# remove self loop & multiple edges"
"0","gomni2 <- simplify(gomni) # not working? try manually"
"0","Aomni <- as.matrix(gomni2[]); Aomni[Aomni>0] <- 1"
"0","gomni2 <- graph.adjacency(Aomni)"
"0","summary(gomni2)"
"1","IGRAPH 6debf4b DN-- 213 7536 -- "
"1","
"
"1","+ attr: name (v/c)"
"1","
"
"0","#range(gomni2[]) # 0 1"
"0","#sum(diag(gomni2[])) # 0"
"0","set.seed(12345)"
"0","cl <- as.numeric(factor(vdf$type))"
"0","vcol2 <- rainbow(4,alpha=.5)"
"0","#plotmemb(gomni2[],cl,drawborder=TRUE,lwd=.02,lcol=vcol2,lwdb=3)"
