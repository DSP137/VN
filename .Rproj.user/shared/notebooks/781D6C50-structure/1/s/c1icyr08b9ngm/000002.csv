"0","#source(""~/Dropbox/RFiles/plotcolordist.R"")"
"0","plotmemb <- function(X,cl,inorder=FALSE,main="""",drawborder=TRUE,lwd=0.5,lwdb=1,lcol=2)"
"0","{"
"0","    suppressMessages(require(lattice))"
"0","    suppressMessages(require(Matrix))"
"0","    if (inorder) {"
"0","        tmp <- sort(table(cl),dec=TRUE)"
"0","    } else {"
"0","        tmp <- table(cl)"
"0","    }"
"0","    tmp <- as.numeric(names(tmp))"
"0","    ind2 <- unlist(sapply(1:max(tmp), function(x) which(cl==tmp[x])))"
"0","    #X2 <- as.matrix(X)"
"0","    AS <- X[ind2,ind2]"
"0","    p <- Matrix::image(AS,lwd=lwd,main=main)"
"0","    print(p)"
"0","    if (drawborder) {"
"0","        trellis.focus(""panel"", 1, 1, highlight=FALSE)"
"0","        if (length(lcol)==1) lcol <- rep(lcol,max(cl))"
"0","        nc <- table(cl)"
"0","        nc.x <- nc.y <- c(1,cumsum(nc)+1)"
"0","        for (i in 1:max(cl)) {"
"0","            x1 <- nc.x[i]; x2 <- nc.x[i+1]"
"0","            lrlab <- nc.y[i]; gwlab <- nc.y[i+1]"
"0","            lpolygon(c(x1,x1,x2,x2), c(lrlab,gwlab,gwlab,lrlab),border=lcol[i],lwd=lwdb)"
"0","        }"
"0","        trellis.unfocus()"
"0","    }"
"0","}"
"0","## make all possible pairs for pair plot with ggplot"
"0","makePairs <- function(data) "
"0","{"
"0","  grid <- expand.grid(x = 1:ncol(data), y = 1:ncol(data))"
"0","  grid <- subset(grid, x != y)"
"0","  all <- do.call(""rbind"", lapply(1:nrow(grid), function(i) {"
"0","    xcol <- grid[i, ""x""]"
"0","    ycol <- grid[i, ""y""]"
"0","    data.frame(xvar = names(data)[ycol], yvar = names(data)[xcol], "
"0","               x = data[, xcol], y = data[, ycol], data)"
"0","  }))"
"0","  all$xvar <- factor(all$xvar, levels = names(data))"
"0","  all$yvar <- factor(all$yvar, levels = names(data))"
"0","  densities <- do.call(""rbind"", lapply(1:ncol(data), function(i) {"
"0","    data.frame(xvar = names(data)[i], yvar = names(data)[i], x = data[, i])"
"0","  }))"
"0","  list(all=all, densities=densities)"
"0","}"
"0","vtype <- matrix(c(""KC"",""KC"",""KC"",""MBIN"",""KC"",""MBON"",""MBIN"",""KC"",""PN"",""KC"","
"0","                  ""MBIN"",""MBON"",""MBON"",""MBIN"",""MBON"",""MBON""),ncol=2,byrow=TRUE)"
"0","source(""~/Dropbox/RFiles/getElbows.R"")"
"0","vcol <- rainbow(4)"
